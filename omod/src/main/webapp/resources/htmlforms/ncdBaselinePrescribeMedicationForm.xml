<htmlform
	formUuid="aab2cab6-c280-438b-9afd-3c54e799ef2a"
	formName="Prescribe Medication"
	formEncounterType="fa6f3ff5-b784-43fb-ab35-a08ab7dbf074"
	formVersion="1.1" formAddMetadata="no">
	<!-- Autogenerated example form  (template from 01-Nov-2010 -->
	<macros>
		paperFormId = (Fill this in)
		headerColor =#009d8e
		fontOnHeaderColor = white
	</macros>

	<script type="text/javascript">
        if (jQuery) {
            jq(document).ready(function () {
                <!-- add the links to the actual forms -->
                jq("#medicalhistory").attr("href", jq("#medical-history-form-url").html() + '&amp;patientId=' + jq('input[name=personId]').val());
                jq("#lifestyle").attr("href", jq("#lifestyle-form-url").html() + '&amp;patientId=' + jq('input[name=personId]').val());
                jq("#diagnosis").attr("href", jq("#diagnosis-form-url").html() + '&amp;patientId=' + jq('input[name=personId]').val());
                jq("#prescribemedication").attr("href", jq("#prescribe-medication-form-url").html() + '&amp;patientId=' + jq('input[name=personId]').val());
                jq("#clinicalnote").attr("href", jq("#clinical-note-form-url").html() + '&amp;patientId=' + jq('input[name=personId]').val());

                // enabling and disabling the allergy sections there are only 5 so far
                jq('#1-removeEntry').remove();
                jq('#1-toggleContainer').show();
                jq('#10-addEntry').remove();


                // show and remove sections
                jq('button.addEntry').on("click", function(){
                    var correctedAddButtonId = parseFloat(this.id) + 1;
                    var contentAddId = "#" + correctedAddButtonId + "-toggleContainer";
                    jq(contentAddId).toggle(true);
                    jq('#' + this.id).toggle(false);
                    jq('#' + parseFloat(this.id) + '-removeEntry').toggle(false);
                    return false;
                });

                jq('button.removeEntry').on("click", function () {
                    var correctedRemoveButtonId = parseFloat(this.id) - 1;
                    var contentAddId = "#" + parseFloat(this.id) + "-toggleContainer";
                    jq(contentAddId).toggle(false);
                    jq(':input:not(:button)', contentAddId).val([]);
                    jq('#' + correctedRemoveButtonId + '-addEntry').toggle(true);
                    jq('#' + correctedRemoveButtonId + '-removeEntry').toggle(true);
                    return false;
                });

                // show any prescriptions that have been saved
                for (i = 1; i &lt; 10; i++) {
                    if (getValue('name-' + i + '.value') != false) {
                        jq('#' + i + '-addEntry').toggle(false);
                        jq('#' + i + '-toggleContainer').show();
                    }
                }
            });
        }
	</script>

	<div class="wrapper">
		<uiInclude provider="msfcore" fragment="leftMenu"/>
		<div class="right-form-display">
			<div style="display:none;">
				<section headerLabel="Encounter Details">
					<table class="baseline-aligned">
						<tr>
							<td>Date:</td>
							<td>
								<encounterDate default="now" disallowMultipleEncountersOnDate="block"/>
							</td>
						</tr>
						<tr>
							<td>Location:</td>
							<td>
								<encounterLocation default="SessionAttribute:emrContext.sessionLocationId"/>
							</td>
						</tr>
						<tr>
							<td>Provider:</td>
							<td>
								<encounterProvider default="currentUser"/>
							</td>
						</tr>
					</table>
				</section>
			</div>

			<div class="sections-container">
				<section id="drug-orders">
                    <h3>6. <lookup expression="fn.message('msfcore.ncdbaseline.prescribemedication.title')"/></h3>
					<repeat>
						<template>
							<div id="{prescription}-toggleContainer" style="display: none;">
								<h4><lookup expression="fn.message('msfcore.ncdbaseline.prescribemedication.medication')"/> {prescription}</h4>
								<table class="baseline-aligned">
									<tr>

										<td colspan="2">
											<label><lookup expression="fn.message('msfcore.ncdbaseline.prescribemedication.name')"/></label>
											<obs id="name-{prescription}" class="medication-name" conceptId="17110937-6cb2-42f9-b932-3f79e9506a1d"/>
										</td>
									</tr>
									<tr>
										<td>
											<label><lookup expression="fn.message('msfcore.ncdbaseline.prescribemedication.dose')"/></label>
											<obs id="dose{prescription}" class="doseInput" conceptId="160856"/>
											<obs id="doseUnit{prescription}" class="doseInput select-arrow" conceptId="d09764da-2bf1-4ab6-933f-07a50add8f33"
												 answerConceptIds="161553,161554,162263,162376,1608,1513,162356,162366,162370,162264" />
										</td>
										<td><lookup expression="fn.message('msfcore.ncdbaseline.prescribemedication.frequency')"/>
											<obs id="frequencyCoded{prescription}" class="frequency select-arrow" conceptId="160855" />
										</td>
									</tr>
									<tr>
										<td><lookup expression="fn.message('msfcore.ncdbaseline.prescribemedication.duration')"/>
											<obs id="duration{prescription}" class="duration doseInput" conceptId="159368"/>

										</td>
										<td><lookup expression="fn.message('msfcore.ncdbaseline.prescribemedication.amount')"/>
                                            <obs id="durationUnit{prescription}" class="duration-unit select-arrow" conceptId="161244"/>

										</td>
									</tr>
									<tr>
										<td colspan="2"><label><lookup expression="fn.message('msfcore.ncdbaseline.prescribemedication.administrativeinstructions')"/></label>
                                            <obs id="instructions{prescription}" class="medication-instructions" conceptId="163106" style="textarea" rows="3" cols="80"/></td>

									</tr>

									<tfoot class="hide-on-view">
									<tr>
										<td></td>
										<td><button class="addEntry" id="{prescription}-addEntry"><lookup expression="fn.message('msfcore.ncdbaseline.prescribemedication.addprescription')"/></button> | <button
												class="removeEntry" id="{prescription}-removeEntry"><lookup expression="fn.message('msfcore.ncdbaseline.prescribemedication.removeprescription')"/></button>
										</td>
									</tr>
									</tfoot>
								</table>
							</div>
						</template>
						<render prescription="1"/>
						<render prescription="2"/>
						<render prescription="3"/>
						<render prescription="4"/>
						<render prescription="5"/>
						<render prescription="6"/>
						<render prescription="7"/>
						<render prescription="8"/>
						<render prescription="9"/>
						<render prescription="10"/>
					</repeat>
                    <submit submitLabel="Next >"/>
				</section>
			</div>
		</div>
	</div>


	<!-- Enusre that only one version of this form can exist at any one time -->
	<ifMode mode="ENTER" include="true">
		<lookup complexExpression="
            #set( $encounter = 0 )
            #set( $encounter = $fn.allEncounters('fa6f3ff5-b784-43fb-ab35-a08ab7dbf074'))
            #foreach($encounter in $fn.allEncounters(null))
                #if( $encounter.form.uuid == 'aab2cab6-c280-438b-9afd-3c54e799ef2a' )
                    &lt;script type=&quot;text/javascript&quot;>
                        window.location.href = window.location.protocol + &quot;//&quot; + window.location.host + &quot;/&quot;+ OPENMRS_CONTEXT_PATH + &quot;/htmlformentryui/htmlform/editHtmlFormWithStandardUi.page?formUuid=$encounter.form.uuid&amp;patientId=$patient.uuid&amp;encounterId=$encounter.uuid&amp;&quot;;
                    &lt;/script>
                #end
            #end"/>

	</ifMode>
	<redirectOnSave
			url="/htmlformentryui/htmlform/enterHtmlFormWithStandardUi.page?formUuid=f88f341a-2a37-47e9-ac81-b5dae813ab26&amp;patientId={{patient.id}}&amp;visitId={{visit.id}"/>
</htmlform>